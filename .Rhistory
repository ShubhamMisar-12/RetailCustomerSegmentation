ylab = "Proportion of Variance Explained",
type = "b")
plot(cumsum(pve), xlab = "Principal Component",
ylab = "Cumulative Proportion of Variance Explained",
type = "b")
a <- c(1, 2, 8, -3)
cumsum(a)
# as R practice let's save it as csv file and load id
# use write_csv/read_csv functions from readr library
tibble::rownames_to_column(USArrests,var = "State") %>%
readr::write_csv(df, file="usarrests.csv")
df <- readr::read_csv(file="usarrests.csv")
# as R practice let's save it as csv file and load id
# use write_csv/read_csv functions from readr library
tibble::rownames_to_column(USArrests,var = "State") %>%
readr::write_csv(df, file="usarrests.csv")
features <- df %>%
select(Age, Has_Partner, Is_Parent, Family_Size, Education, Income, Recency, campaign_participation, Total_Purchaase
)
features
features$Education = as.integer(factor(features$Education, levels = c("Undergraduate", "Graduate", "Postgraduate")))
features_scaled <- features %>%
scale()
features_scaled <- na.omit(features_scaled)
pca <- prcomp(features_scaled)
pca
screeplot(pca)
ggbiplot(pca)
pr.var <- pca$sdev^2
pr.var
pve <- 100 * pr.var/ sum(pr.var)
pve
par(mfrow = c(1, 2))
plot(pve, xlab = "Principal Component",
ylab = "Proportion of Variance Explained",
type = "b")
plot(cumsum(pve), xlab = "Principal Component",
ylab = "Cumulative Proportion of Variance Explained",
type = "b")
library(plotly)
p <- plot_ly(x = pca$x[,1], y = pca$x[,2], z = pca$x[,3], type = "scatter3d",
mode = "markers") %>%
layout(scene = list(xaxis = list(title = "PC1"), yaxis = list(title = "PC2"),
zaxis = list(title = "PC3")))
# Display the plot
p
km <- kmeans(pca$x[,1:3], 3)
# Add cluster assignment to the pca object
pca$cluster <- as.factor(km$cluster)
p <- plot_ly(x = pca$x[,1], y = pca$x[,2], z = pca$x[,3], type = "scatter3d",
mode = "markers", color = pca$cluster) %>%
layout(scene = list(xaxis = list(title = "PC1"), yaxis = list(title = "PC2"),
zaxis = list(title = "PC3")))
# Display the plot
p
km <- kmeans(pca$x[,1:3], 5
)
# Add cluster assignment to the pca object
pca$cluster <- as.factor(km$cluster)
p <- plot_ly(x = pca$x[,1], y = pca$x[,2], z = pca$x[,3], type = "scatter3d",
mode = "markers", color = pca$cluster) %>%
layout(scene = list(xaxis = list(title = "PC1"), yaxis = list(title = "PC2"),
zaxis = list(title = "PC3")))
# Display the plot
p
library(dplyr)
library(ggplot2)
library(GGally)
df <- read.csv('./Customer_Data.csv')
df
df <- read.csv('./Customer_Data.csv')
df
sum(is.na(df))
df[duplicated(df)]
df <- df %>%
select(-ID)
df
df <- na.omit(df)
sum(is.na(df))
df %>%
select(Dt_Customer)
df<- df %>%
mutate(Dt_Customer = gsub("/", "-", Dt_Customer))
df<- df %>%
mutate(Dt_Customer = as.Date(Dt_Customer, format("%d-%m-%Y")))
summary(df$Dt_Customer)
df <- df %>%
mutate(Age = 2014 - Year_Birth)
df <- df %>%
mutate(Age = 2014 - Year_Birth)
ggplot(df, aes(x = Age)) +
geom_histogram(fill = "#1f77b7", bins = 40, alpha = 0.8) +
labs(x = "Age",
y = "count",
title = "Distribution of Age")
df %>%
filter(Income != 666666) %>%
ggplot(aes(x = Age, y = Income) )+
geom_point(color = "#0072B2", size = 2)+
theme_minimal()
df<- df %>%
filter(Income != 666666) %>%
mutate(Age = ifelse(Age > 70, 70, Age))
ggplot(df, aes(x = Age)) +
geom_histogram(fill = "#1f77b7", bins = 40, alpha = 0.8) +
labs(x = "Age",
y = "count",
title = "Distribution of Age")
df_product <- df[,c("MntWines","MntFruits", "MntMeatProducts", "MntFishProducts", "MntSweetProducts", "MntGoldProds")]
library(ggcorrplot)
corr_mat_products <- cor(df_product)
# Create the correlation plot using ggcorrplot
ggcorrplot(corr_mat_products, hc.order = TRUE) +
theme(plot.title = element_text(hjust = 0.8)) +
geom_text(aes(label = value)) +
ggtitle("Correlation Plot of Sample Data")
library(ggcorrplot)
corr_mat_products <- cor(df_product)
ggcorrplot(corr_mat_products, hc.order = TRUE) +
theme(plot.title = element_text(hjust = 0.8)) +
geom_text(aes(label = value)) +
ggtitle("Correlation Plot for Product bought")
df_gateway <- df[,c("NumDealsPurchases", "NumStorePurchases", "NumWebPurchases", "NumCatalogPurchases", "NumWebVisitsMonth")]
corr_mat_gtwy <- cor(df_gateway)
ggcorrplot(corr_mat_gtwy, hc.order = TRUE) +
theme(plot.title = element_text(hjust = 0.8)) +
geom_text(aes(label = value)) +
ggtitle("Correlation Plot of Sample Data")
df_campaign <- df[,c("AcceptedCmp1", "AcceptedCmp2", "AcceptedCmp3", "AcceptedCmp4", "AcceptedCmp5")]
corr_mat_campaign <- cor(df_campaign)
plot(df_gateway)
ggplot(df_gateway)
ggplot(df_gateway)+
geom_point()
ggplot(aes(df_gateway) )+
geom_point()
ggpairs(aes(df_gateway))
ggpairs(df_gateway)
ggpairs(df_gateway)
ggpairs(df_gateway) +
theme_dark()
ggpairs(df_gateway) +
theme_minimal_grid()
ggpairs(df_gateway) +
theme_minimal_grid(fill = "#1f77b7")
ggpairs(df_gateway) +
theme_minimal_grid(color = "#1f77b7")
ggpairs(df_gateway) +
theme_minimal(color = "#1f77b7")
ggpairs(df_gateway) +
theme_minimal(fill = "#1f77b7")
ggpairs(df_gateway) +
theme_minimal()
ggpairs(df_product) +
theme_minimal()
ggcorrplot(corr_mat_campaign, hc.order = TRUE) +
theme(plot.title = element_text(hjust = 0.8)) +
geom_text(aes(label = value)) +
ggtitle("Correlation Plot of Sample Data")
df <- df %>%
mutate(Total_Purchaase = MntWines + MntFruits + MntMeatProducts + MntFishProducts + MntSweetProducts + MntSweetProducts + MntGoldProds)
df <- df %>%
mutate(Total_Purchaase = MntWines + MntFruits + MntMeatProducts + MntFishProducts + MntSweetProducts + MntSweetProducts + MntGoldProds)
df %>%
group_by(Marital_Status) %>%
summarise(Total_Purchase_by_Marital = sum(Total_Purchaase)) %>%
ggplot(aes(x = Marital_Status, y = Total_Purchase_by_Marital)) +
geom_col(fill = "#1f77b7") +
theme_minimal()
df %>%
group_by(Age) %>%
summarise(Wines = sum(MntWines), Fruits = sum(MntFruits), Meat = sum(MntMeatProducts), Fish = sum(MntFishProducts), Sweet = sum(MntSweetProducts), gold = sum(MntGoldProds)) %>%
ggplot(aes(x = Age) +
geom_area(fill = "#1f77b7") +
theme_minimal()
df %>%
group_by(Age) %>%
summarise(Wines = sum(MntWines), Fruits = sum(MntFruits), Meat = sum(MntMeatProducts), Fish = sum(MntFishProducts), Sweet = sum(MntSweetProducts), gold = sum(MntGoldProds)) %>%
ggplot(aes(x = Age) +
geom_area(fill = "#1f77b7") +
theme_minimal()
df %>%
group_by(Age) %>%
summarise(Wines = sum(MntWines), Fruits = sum(MntFruits), Meat = sum(MntMeatProducts), Fish = sum(MntFishProducts), Sweet = sum(MntSweetProducts), gold = sum(MntGoldProds)) %>%
geom_bar(aes(y = Wines), stat = "identity", fill = "red") +
theme_minimal()
df %>%
group_by(Marital_Status) %>%
summarise(Wines = sum(MntWines), Fruits = sum(MntFruits), Meat = sum(MntMeatProducts), Fish = sum(MntFishProducts), Sweet = sum(MntSweetProducts), gold = sum(MntGoldProds)) %>%
ggplot(aes(x = Marital_Status)) +
geom_bar(aes(y = Wines), stat = "identity", fill = "blue") +
theme_minimal()
df %>%
group_by(Marital_Status) %>%
summarise(Wines = sum(MntWines), Fruits = sum(MntFruits), Meat = sum(MntMeatProducts), Fish = sum(MntFishProducts), Sweet = sum(MntSweetProducts), gold = sum(MntGoldProds)) %>%
ggplot(aes(x = Marital_Status)) +
geom_bar(aes(y = Wines), stat = "identity", fill = "blue") +
geom_bar(aes(y = Fruits), stat = "identity", fill = "red") +
geom_bar(aes(y = Meat), stat = "identity", fill = "yellow") +
geom_bar(aes(y = Fish), stat = "identity", fill = "green") +
geom_bar(aes(y = Sweet), stat = "identity", fill = "purple") +
geom_bar(aes(y = gold), stat = "identity", fill = "violet") +
theme_minimal()
df %>%
group_by(Marital_Status) %>%
summarise(Wines = sum(MntWines), Fruits = sum(MntFruits), Meat = sum(MntMeatProducts), Fish = sum(MntFishProducts), Sweet = sum(MntSweetProducts), gold = mean(MntGoldProds)) %>%
ggplot(aes(x = Marital_Status)) +
geom_bar(aes(y = Wines), stat = "identity", fill = "blue") +
geom_bar(aes(y = Fruits), stat = "identity", fill = "red") +
geom_bar(aes(y = Meat), stat = "identity", fill = "yellow") +
geom_bar(aes(y = Fish), stat = "identity", fill = "green") +
geom_bar(aes(y = Sweet), stat = "identity", fill = "purple") +
geom_bar(aes(y = gold), stat = "identity", fill = "violet") +
theme_minimal()
df %>%
group_by(Marital_Status) %>%
summarise(Wines = mean(MntWines), Fruits = mean(MntFruits), Meat = mean(MntMeatProducts), Fish = mean(MntFishProducts), Sweet = mean(MntSweetProducts), gold = mean(MntGoldProds)) %>%
ggplot(aes(x = Marital_Status)) +
geom_bar(aes(y = Wines), stat = "identity", fill = "blue") +
geom_bar(aes(y = Fruits), stat = "identity", fill = "red") +
geom_bar(aes(y = Meat), stat = "identity", fill = "yellow") +
geom_bar(aes(y = Fish), stat = "identity", fill = "green") +
geom_bar(aes(y = Sweet), stat = "identity", fill = "purple") +
geom_bar(aes(y = gold), stat = "identity", fill = "violet") +
theme_minimal()
df %>%
group_by(Marital_Status) %>%
summarise(Total_Purchase_by_Marital = mean(Total_Purchaase)) %>%
ggplot(aes(x = Marital_Status, y = Total_Purchase_by_Marital)) +
geom_col(fill = "#1f77b7") +
theme_minimal()
df %>%
group_by(Income) %>%
summarise(Total_Purchase_by_Marital = sum(Total_Purchaase)) %>%
ggplot(aes(x = Income, y = Total_Purchase_by_Marital)) +
geom_point(color = "#1f77b7", size = 2) +
theme_minimal()
df %>%
group_by(Income) %>%
summarise(Total_Purchase_by_Marital = mean(Total_Purchaase)) %>%
ggplot(aes(x = Income, y = Total_Purchase_by_Marital)) +
geom_point(color = "#1f77b7", size = 2) +
theme_minimal()
df %>%
group_by(Age) %>%
summarise(Total_Purchase_by_Marital = mean(Total_Purchaase)) %>%
ggplot(aes(x = Age, y = Total_Purchase_by_Marital)) +
geom_col(fill = "#1f77b7") +
theme_minimal()
df %>%
group_by(Income) %>%
summarise(Wines = mean(MntWines), Fruits = mean(MntFruits), Meat = mean(MntMeatProducts), Fish = mean(MntFishProducts), Sweet = mean(MntSweetProducts), gold = mean(MntGoldProds)) %>%
ggplot(aes(x = Income)) +
geom_scatter(aes(y = Wines), stat = "identity", fill = "blue") +
geom_scatter(aes(y = Fruits), stat = "identity", fill = "red") +
geom_scatter(aes(y = Meat), stat = "identity", fill = "yellow") +
geom_scatter(aes(y = Fish), stat = "identity", fill = "green") +
geom_scatter(aes(y = Sweet), stat = "identity", fill = "purple") +
geom_scatter(aes(y = gold), stat = "identity", fill = "violet") +
theme_minimal()
df %>%
group_by(Income) %>%
summarise(Wines = mean(MntWines), Fruits = mean(MntFruits), Meat = mean(MntMeatProducts), Fish = mean(MntFishProducts), Sweet = mean(MntSweetProducts), gold = mean(MntGoldProds)) %>%
ggplot(aes(x = Income)) +
geom_point(aes(y = Wines), stat = "identity", fill = "blue") +
geom_scatter(aes(y = Fruits), stat = "identity", fill = "red") +
geom_scatter(aes(y = Meat), stat = "identity", fill = "yellow") +
geom_scatter(aes(y = Fish), stat = "identity", fill = "green") +
geom_scatter(aes(y = Sweet), stat = "identity", fill = "purple") +
geom_scatter(aes(y = gold), stat = "identity", fill = "violet") +
theme_minimal()
df %>%
group_by(Income) %>%
summarise(Wines = mean(MntWines), Fruits = mean(MntFruits), Meat = mean(MntMeatProducts), Fish = mean(MntFishProducts), Sweet = mean(MntSweetProducts), gold = mean(MntGoldProds)) %>%
ggplot(aes(x = Income)) +
geom_point(aes(y = Wines), stat = "identity", fill = "blue") +
geom_point(aes(y = Fruits), stat = "identity", fill = "red") +
geom_point(aes(y = Meat), stat = "identity", fill = "yellow") +
geom_point(aes(y = Fish), stat = "identity", fill = "green") +
geom_point(aes(y = Sweet), stat = "identity", fill = "purple") +
geom_point(aes(y = gold), stat = "identity", fill = "violet") +
theme_minimal()
df %>%
group_by(Income) %>%
summarise(Wines = mean(MntWines), Fruits = mean(MntFruits), Meat = mean(MntMeatProducts), Fish = mean(MntFishProducts), Sweet = mean(MntSweetProducts), gold = mean(MntGoldProds)) %>%
ggplot(aes(x = Income)) +
geom_point(aes(y = Wines), stat = "identity", color = "blue") +
geom_point(aes(y = Fruits), stat = "identity", fill = "red") +
geom_point(aes(y = Meat), stat = "identity", fill = "yellow") +
geom_point(aes(y = Fish), stat = "identity", fill = "green") +
geom_point(aes(y = Sweet), stat = "identity", fill = "purple") +
geom_point(aes(y = gold), stat = "identity", fill = "violet") +
theme_minimal()
df %>%
group_by(Income) %>%
summarise(Wines = mean(MntWines), Fruits = mean(MntFruits), Meat = mean(MntMeatProducts), Fish = mean(MntFishProducts), Sweet = mean(MntSweetProducts), gold = mean(MntGoldProds)) %>%
ggplot(aes(x = Income)) +
geom_point(aes(y = Wines), stat = "identity", color = "blue") +
geom_point(aes(y = Fruits), stat = "identity", color = "red") +
geom_point(aes(y = Meat), stat = "identity", color = "yellow") +
geom_point(aes(y = Fish), stat = "identity", color = "green") +
geom_point(aes(y = Sweet), stat = "identity", color = "purple") +
geom_point(aes(y = gold), stat = "identity", color = "violet") +
theme_minimal()
df %>%
group_by(Age) %>%
summarise(Wines = mean(MntWines), Fruits = mean(MntFruits), Meat = mean(MntMeatProducts), Fish = mean(MntFishProducts), Sweet = mean(MntSweetProducts), gold = mean(MntGoldProds)) %>%
ggplot(aes(x = Age)) +
geom_point(aes(y = Wines), stat = "identity", color = "blue") +
geom_point(aes(y = Fruits), stat = "identity", color = "red") +
geom_point(aes(y = Meat), stat = "identity", color = "yellow") +
geom_point(aes(y = Fish), stat = "identity", color = "green") +
geom_point(aes(y = Sweet), stat = "identity", color = "purple") +
geom_point(aes(y = gold), stat = "identity", color = "violet") +
theme_minimal()
df %>%
group_by(Income) %>%
summarise(Wines = mean(MntWines), Fruits = mean(MntFruits), Meat = mean(MntMeatProducts), Fish = mean(MntFishProducts), Sweet = mean(MntSweetProducts), gold = mean(MntGoldProds)) %>%
ggplot(aes(x = Income)) +
geom_point(aes(y = Wines, color = "Wines"), alpha = 0.7, size = 3) +
geom_point(aes(y = Fruits, color = "Fruits"), alpha = 0.7, size = 3) +
geom_point(aes(y = Meat, color = "Meat"), alpha = 0.7, size = 3) +
geom_point(aes(y = Fish, color = "Fish"), alpha = 0.7, size = 3) +
geom_point(aes(y = Sweet, color = "Sweet"), alpha = 0.7, size = 3) +
geom_point(aes(y = gold, color = "Gold Prods"), alpha = 0.7, size = 3) +
scale_color_manual(name = "Products", values = c("Wines" = "#E69F00", "Fruits" = "#56B4E9", "Meat" = "#009E73", "Fish" = "#0072B2", "Sweet" = "#D55E00", "Gold Prods" = "#CC79A7")) +
theme_minimal() +
theme(legend.position = "bottom")
df %>%
group_by(Income) %>%
summarise(Wines = mean(MntWines), Fruits = mean(MntFruits), Meat = mean(MntMeatProducts), Fish = mean(MntFishProducts), Sweet = mean(MntSweetProducts), gold = mean(MntGoldProds)) %>%
ggplot(aes(x = Income)) +
geom_point(aes(y = Wines, color = "Wines"), alpha = 0.7, size = 1) +
geom_point(aes(y = Fruits, color = "Fruits"), alpha = 0.7, size = 1) +
geom_point(aes(y = Meat, color = "Meat"), alpha = 0.7, size = 1) +
geom_point(aes(y = Fish, color = "Fish"), alpha = 0.7, size = 1) +
geom_point(aes(y = Sweet, color = "Sweet"), alpha = 0.7, size = 1) +
geom_point(aes(y = gold, color = "Gold Prods"), alpha = 0.7, size = 1) +
scale_color_manual(name = "Products", values = c("Wines" = "#E69F00", "Fruits" = "#56B4E9", "Meat" = "#009E73", "Fish" = "#0072B2", "Sweet" = "#D55E00", "Gold Prods" = "#CC79A7")) +
theme_minimal() +
theme(legend.position = "bottom")
df %>%
group_by(Income) %>%
summarise(Wines = mean(MntWines), Fruits = mean(MntFruits), Meat = mean(MntMeatProducts), Fish = mean(MntFishProducts), Sweet = mean(MntSweetProducts), gold = mean(MntGoldProds)) %>%
ggplot(aes(x = Income)) +
geom_point(aes(y = Wines, color = "Wines"), alpha = 0.7, size = 2) +
geom_point(aes(y = Fruits, color = "Fruits"), alpha = 0.7, size = 2) +
geom_point(aes(y = Meat, color = "Meat"), alpha = 0.7, size = 2) +
geom_point(aes(y = Fish, color = "Fish"), alpha = 0.7, size = 2) +
geom_point(aes(y = Sweet, color = "Sweet"), alpha = 0.7, size = 2) +
geom_point(aes(y = gold, color = "Gold Prods"), alpha = 0.7, size = 2) +
scale_color_manual(name = "Products", values = c("Wines" = "#E69F00", "Fruits" = "#56B4E9", "Meat" = "#009E73", "Fish" = "#0072B2", "Sweet" = "#D55E00", "Gold Prods" = "#CC79A7")) +
theme_minimal() +
theme(legend.position = "right")
df %>%
group_by(Age) %>%
summarise(Wines = mean(MntWines), Fruits = mean(MntFruits), Meat = mean(MntMeatProducts), Fish = mean(MntFishProducts), Sweet = mean(MntSweetProducts), gold = mean(MntGoldProds)) %>%
ggplot(aes(x = Age)) +
geom_point(aes(y = Wines, color = "Wines"), alpha = 0.7, size = 2) +
geom_point(aes(y = Fruits, color = "Fruits"), alpha = 0.7, size = 2) +
geom_point(aes(y = Meat, color = "Meat"), alpha = 0.7, size = 2) +
geom_point(aes(y = Fish, color = "Fish"), alpha = 0.7, size = 2) +
geom_point(aes(y = Sweet, color = "Sweet"), alpha = 0.7, size = 2) +
geom_point(aes(y = gold, color = "Gold Prods"), alpha = 0.7, size = 2) +
scale_color_manual(name = "Products", values = c("Wines" = "#E69F00", "Fruits" = "#56B4E9", "Meat" = "#009E73", "Fish" = "#0072B2", "Sweet" = "#D55E00", "Gold Prods" = "#CC79A7")) +
theme_minimal() +
theme(legend.position = "right")
df %>%
group_by(Marital_Status) %>%
summarise(Wines = mean(MntWines), Fruits = mean(MntFruits), Meat = mean(MntMeatProducts), Fish = mean(MntFishProducts), Sweet = mean(MntSweetProducts), gold = mean(MntGoldProds)) %>%
ggplot(aes(x = Marital_Status)) +
geom_bar(aes(y = Wines), stat = "identity", fill = "#FF7F00", alpha = 0.7) +
geom_bar(aes(y = Fruits), stat = "identity", fill = "#4DAF4A", alpha = 0.7) +
geom_bar(aes(y = Meat), stat = "identity", fill = "#984EA3", alpha = 0.7) +
geom_bar(aes(y = Fish), stat = "identity", fill = "#377EB8", alpha = 0.7) +
geom_bar(aes(y = Sweet), stat = "identity", fill = "#E41A1C", alpha = 0.7) +
geom_bar(aes(y = gold), stat = "identity", fill = "#999999", alpha = 0.7) +
labs(title = "Average Spending on Product Categories by Marital Status",
x = "Marital Status",
y = "Average Spending",
fill = "Product Categories") +
theme_minimal() +
theme(legend.position = "top", legend.title = element_text(size = 12),
legend.text = element_text(size = 10), axis.text.x = element_text(angle = 45, hjust = 1))
df %>%
group_by(Marital_Status) %>%
summarise(Wines = mean(MntWines), Fruits = mean(MntFruits), Meat = mean(MntMeatProducts), Fish = mean(MntFishProducts), Sweet = mean(MntSweetProducts), gold = mean(MntGoldProds)) %>%
ggplot(aes(x = Marital_Status)) +
geom_bar(aes(y = Wines), stat = "identity", fill = "#FF7F00", alpha = 0.7) +
geom_bar(aes(y = Fruits), stat = "identity", fill = "#4DAF4A", alpha = 0.7) +
geom_bar(aes(y = Meat), stat = "identity", fill = "#984EA3", alpha = 0.7) +
geom_bar(aes(y = Fish), stat = "identity", fill = "#377EB8", alpha = 0.7) +
geom_bar(aes(y = Sweet), stat = "identity", fill = "#E41A1C", alpha = 0.7) +
geom_bar(aes(y = gold), stat = "identity", fill = "#999999", alpha = 0.7) +
labs(title = "Average Spending on Product Categories by Marital Status",
x = "Marital Status",
y = "Average Spending",
fill = "Product Categories") +
theme_minimal() +
theme(legend.position = "top")
df %>%
group_by(Marital_Status) %>%
summarise(Wines = mean(MntWines), Fruits = mean(MntFruits), Meat = mean(MntMeatProducts), Fish = mean(MntFishProducts), Sweet = mean(MntSweetProducts), gold = mean(MntGoldProds)) %>%
ggplot(aes(x = Marital_Status)) +
geom_bar(aes(y = Wines), stat = "identity", fill = "#FF7F00", alpha = 0.7) +
geom_bar(aes(y = Fruits), stat = "identity", fill = "#4DAF4A", alpha = 0.7) +
geom_bar(aes(y = Meat), stat = "identity", fill = "#984EA3", alpha = 0.7) +
geom_bar(aes(y = Fish), stat = "identity", fill = "#377EB8", alpha = 0.7) +
geom_bar(aes(y = Sweet), stat = "identity", fill = "#E41A1C", alpha = 0.7) +
geom_bar(aes(y = gold), stat = "identity", fill = "#999999", alpha = 0.7) +
labs(title = "Average Spending on Product Categories by Marital Status",
x = "Marital Status",
y = "Average Spending",
fill = "Product Categories") +
theme_minimal() +
theme(legend.position = "right")
df %>%
group_by(Marital_Status) %>%
summarise(Wines = mean(MntWines), Fruits = mean(MntFruits), Meat = mean(MntMeatProducts), Fish = mean(MntFishProducts), Sweet = mean(MntSweetProducts), gold = mean(MntGoldProds)) %>%
ggplot(aes(x = Marital_Status)) +
geom_bar(aes(y = Wines), stat = "identity", fill = "#FF7F00", alpha = 0.7) +
geom_bar(aes(y = Fruits), stat = "identity", fill = "#4DAF4A", alpha = 0.7) +
geom_bar(aes(y = Meat), stat = "identity", fill = "#984EA3", alpha = 0.7) +
geom_bar(aes(y = Fish), stat = "identity", fill = "#377EB8", alpha = 0.7) +
geom_bar(aes(y = Sweet), stat = "identity", fill = "#E41A1C", alpha = 0.7) +
geom_bar(aes(y = gold), stat = "identity", fill = "#999999", alpha = 0.7) +
labs(title = "Average Spending on Product Categories by Marital Status",
x = "Marital Status",
y = "Average Spending") +
theme_minimal() +
theme(legend.position = "right")
df %>%
group_by(Education) %>%
summarise(Wines = mean(MntWines), Fruits = mean(MntFruits), Meat = mean(MntMeatProducts), Fish = mean(MntFishProducts), Sweet = mean(MntSweetProducts), gold = mean(MntGoldProds)) %>%
ggplot(aes(x = Education)) +
geom_bar(aes(y = Wines, fill = "Wines"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = Fruits, fill = "Fruits"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = Meat, fill = "Meat"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = Fish, fill = "Fish"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = Sweet, fill = "Sweet"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = gold, fill = "Gold"), stat = "identity", alpha = 0.7) +
scale_fill_manual(values = c("Wines" = "#1F77B4", "Fruits" = "#FF7F0E", "Meat" = "#2CA02C", "Fish" = "#D62728", "Sweet" = "#9467BD", "Gold" = "#8C564B")) +
theme_minimal() +
theme(legend.position = "right")
df %>%
group_by(Education) %>%
summarise(Wines = mean(MntWines), Fruits = mean(MntFruits), Meat = mean(MntMeatProducts), Fish = mean(MntFishProducts), Sweet = mean(MntSweetProducts), gold = mean(MntGoldProds)) %>%
ggplot(aes(x = Education)) +
geom_bar(aes(y = Wines, fill = "Wines"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = Fruits, fill = "Fruits"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = Meat, fill = "Meat"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = Fish, fill = "Fish"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = Sweet, fill = "Sweet"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = gold, fill = "Gold"), stat = "identity", alpha = 0.7) +
scale_fill_manual(values = c("Wines" = "#1F77B4", "Fruits" = "#FF7F0E", "Meat" = "#2CA02C", "Fish" = "#D62728", "Sweet" = "#9467BD", "Gold" = "#8C564B")) +
labs(title = "Average Spending on Product Categories by Education",
x = "Education",
y = "Average Spending",
fill = "Type of Product")
theme_minimal() +
theme(legend.position = "right")
df %>%
group_by(Education) %>%
summarise(Wines = mean(MntWines), Fruits = mean(MntFruits), Meat = mean(MntMeatProducts), Fish = mean(MntFishProducts), Sweet = mean(MntSweetProducts), gold = mean(MntGoldProds)) %>%
ggplot(aes(x = Education)) +
geom_bar(aes(y = Wines, fill = "Wines"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = Fruits, fill = "Fruits"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = Meat, fill = "Meat"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = Fish, fill = "Fish"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = Sweet, fill = "Sweet"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = gold, fill = "Gold"), stat = "identity", alpha = 0.7) +
scale_fill_manual(values = c("Wines" = "#1F77B4", "Fruits" = "#FF7F0E", "Meat" = "#2CA02C", "Fish" = "#D62728", "Sweet" = "#9467BD", "Gold" = "#8C564B")) +
labs(title = "Average Spending on Product Categories by Education",
x = "Education",
y = "Average Spending",
fill = "Type of Product")+
theme_minimal() +
theme(legend.position = "right")
df %>%
group_by(Marital_Status) %>%
summarise(Wines = mean(MntWines), Fruits = mean(MntFruits), Meat = mean(MntMeatProducts), Fish = mean(MntFishProducts), Sweet = mean(MntSweetProducts), gold = mean(MntGoldProds)) %>%
ggplot(aes(x = Marital_Status)) +
geom_bar(aes(y = Wines, fill = "Wines"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = Fruits, fill = "Fruits"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = Meat, fill = "Meat"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = Fish, fill = "Fish"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = Sweet, fill = "Sweet"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = gold, fill = "Gold"), stat = "identity", alpha = 0.7) +
scale_fill_manual(values = c("Wines" = "#1F77B4", "Fruits" = "#FF7F0E", "Meat" = "#2CA02C", "Fish" = "#D62728", "Sweet" = "#9467BD", "Gold" = "#8C564B")) +
labs(title = "Average Spending on Product Categories by Education",
x = "Education",
y = "Average Spending",
fill = "Type of Product")+
theme_minimal() +
theme(legend.position = "right")
df %>%
group_by(Marital_Status) %>%
summarise(Wines = mean(MntWines), Fruits = mean(MntFruits), Meat = mean(MntMeatProducts), Fish = mean(MntFishProducts), Sweet = mean(MntSweetProducts), gold = mean(MntGoldProds)) %>%
ggplot(aes(x = Marital_Status)) +
geom_bar(aes(y = Wines, fill = "Wines"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = Fruits, fill = "Fruits"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = Meat, fill = "Meat"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = Fish, fill = "Fish"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = Sweet, fill = "Sweet"), stat = "identity", alpha = 0.7) +
geom_bar(aes(y = gold, fill = "Gold"), stat = "identity", alpha = 0.7) +
scale_fill_manual(values = c("Wines" = "#1F77B4", "Fruits" = "#FF7F0E", "Meat" = "#2CA02C", "Fish" = "#D62728", "Sweet" = "#9467BD", "Gold" = "#8C564B")) +
labs(title = "Average Spending on Product Categories by Marital Status",
x = "Marital Status",
y = "Average Spending",
fill = "Type of Product")+
theme_minimal() +
theme(legend.position = "right")
