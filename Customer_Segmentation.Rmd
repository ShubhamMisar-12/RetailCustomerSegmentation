---
title: "CustomerSegmentation"
output: html_document
date: "2023-04-29"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
library(dplyr)
library(ggplot2)
library(GGally)

```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
df <- read.csv('./Customer_Data.csv')
df
```

```{r}
sum(is.na(df))
```


## EDA

```{r}
df[duplicated(df)]
```


```{r}
df <- df %>% 
  select(-ID)
```


```{r}
df
```


```{r}
ggplot(df, aes(x=Year_Birth))+ 
     geom_histogram(color = "grey", fill = "#1f77b4", bins = 30)+
  labs(x = "Year of Birth",
       y = "count", 
       title = "Distribution of Birth Year")+
  theme_minimal()

```

```{r}
df %>% 
  filter(Year_Birth < 1930)
```

seems like they are erroneous entries

```{r}
ggplot(df, aes(Marital_Status)) +
  geom_bar(fill = "#1f77b7", alpha = 0.8) + 
  labs( x= "Marital Status",
        y = "count",
        title = "Frequency plot for marital status")+
  theme_minimal()
```

```{r}
ggplot(df, aes(x = Income)) + 
  geom_histogram(fill = "#1f77b7", alpha = 0.8)+ 
  labs(x = "Income",
       y = "Count",
       title = "Distribution of Income")+
  scale_x_continuous(breaks = seq(5000, 100000, by=  40000))+
  theme_minimal()
```
There is an outlier in data where we see a very large income, to see the distribution clearly lets filter our data


```{r}
df %>% 
  filter(Income < 500000) %>% 
  ggplot(aes(x = Income)) + 
  geom_histogram(fill = "#1f77b7", alpha = 0.8)+ 
  labs(x = "Income",
       y = "Count",
       title = "Distribution of Income")+
  scale_x_continuous(breaks = seq(5000, 200000, by=  20000))+
  theme_minimal()
```
There are few data points with income greater than 85000 lets call them high income group while rest looks to in the range 19000 - 70000


```{r fig.width=20}
ggplot(df, aes(x = "", y = Income)) + 
  geom_violin(fill = "#69b3a2", color = "#e9ecef", alpha = 0.8)+
  coord_flip()+
  scale_y_continuous(breaks = seq(5000, 165000, by=  40000))+
  labs(
    x = "Income",
    y = "Distribution",
    title = "Income Distribution"
  )+
  theme_minimal(base_size  = 20)

```


## Inspecting the missing data

```{r}
df[!complete.cases(df),]
```

```{r}
summary(df)
```

The missing values seems to have occured at random as there are 24 missing values which is 1% of the total data, we can omit those values.


```{r}
df <- na.omit(df)
```

```{r}
sum(is.na(df))
```

Formatting Date column 

```{r}
df %>% 
  select(Dt_Customer)
```

```{r}
df<- df %>% 
  mutate(Dt_Customer = gsub("/", "-", Dt_Customer))
```


```{r}
df<- df %>% 
  mutate(Dt_Customer = as.Date(Dt_Customer, format("%d-%m-%Y")))
```

```{r}
summary(df$Dt_Customer)
```


